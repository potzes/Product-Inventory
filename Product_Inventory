#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void menu(int *act2);

int main()
{
    int act;
    int id = 0;
    int tot = 0;
    
    typedef struct
    {
        char name[20];
        int price;
        int stock;
    }product;
    product *prod = NULL;

    do
    {
        printf("\n==== Inventory Management ====\n");
        printf("1 - Add New Product\n");
        printf("2 - View Inventory\n");
        printf("3 - Search Product\n");
        printf("4 - Exit\n");
        scanf("%d", &act);
        switch(act)
        {
            case 1:
            {
                tot++;
                product *temp = realloc(prod, tot * sizeof(product));
                if(temp == NULL)
                {
                    printf("Memory failed\n");
                    return 1;
                }
                prod = temp;
                printf("\nEnter product name: ");
                scanf(" %[^\n]", prod[tot - 1].name);
                printf("Enter product price: ");
                scanf("%d", &prod[tot - 1].price);
                printf("Enter product stock: ");
                scanf("%d", &prod[tot - 1].stock);
                menu(&act);
                break;
            }
            
            case 2:
            {
                for(int i = 0; i < tot; i++)
                {
                    printf("\nName: %s\n", prod[i].name);
                    printf("Price: %d\n", prod[i].price);
                    printf("Stock: %d\n", prod[i].stock);
                }
                menu(&act);
                break;
            }
            case 3:
            {
                char search[20];
                printf("Search product name: ");
                scanf(" %[^\n]", search);
                for(int ii = 0; ii < tot; ii++)
                {
                    if(strcmp(search, prod[ii].name)==0)
                    {
                        printf("\nName: %s\n", prod[ii].name);
                        printf("Price: %d\n", prod[ii].price);
                        printf("Stock: %d\n", prod[ii].stock);
                        int actt;
                        printf("\n---------------\n");
                        printf("1 - Edit product\n");
                        printf("2 - Menu\n");
                        printf("3 - Exit\n");
                        scanf("%d", &actt);
                        printf("---------------\n");    
                        switch(actt)
                        {
                            case 1:
                            {
                                int acttt;
                                printf("1 - Edit product name\n");
                                printf("2 - Edit product price\n");
                                printf("3 - Edit product stock\n");
                                scanf("%d", &acttt);
                                switch(acttt)
                                {
                                    case 1:
                                    {
                                        printf("Enter updated product name: ");
                                        scanf(" %[^\n]", &prod[ii].name);
                                        printf("Updated successfully\n");
                                        menu(&act);
                                        break;
                                    }
                                    
                                    case 2:
                                    {
                                        printf("Enter updated product price: ");
                                        scanf("%d", &prod[ii].price);
                                        printf("Updated successfully\n");
                                        menu(&act);
                                        break;
                                        
                                    case 3:
                                    {
                                        printf("Enter updated product stock: ");
                                        scanf("%d", prod[ii].stock);
                                        printf("Updated successfully\n");
                                        menu(&act);
                                        break;
                                    }
                                    }
                                }
                            }
                            
                            case 2: break;
                    
                            case 3:
                            {
                                act = 4;
                                break;
                            }
                        }
                    }
                }
                break;
            }
        }
    } while(act != 4);
}

void menu(int *act2)
{
    int opt; 
    printf("\n---------------\n");
    printf("1 - Menu\n");
    printf("2 - Exit\n");
    scanf("%d", &opt);
    printf("---------------\n");    
    switch(opt)
    {
        case 1: break;

        case 2:
        {
            *act2 = 4;
            break;
        }
    }

}
